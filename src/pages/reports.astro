---
import Layout from '../layouts/Layout.astro';
---

<Layout>
  <div id="reports-page">
    <header>
      <h1>æ•°æ®æŠ¥å‘Šä¸­å¿ƒ</h1>
      <p>å…¨é¢çš„æ•°æ®åˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆ</p>
    </header>

    <main>
      <!-- æŠ¥å‘Šç±»å‹é€‰æ‹© -->
      <section class="report-types">
        <h2>æŠ¥å‘Šç±»å‹</h2>
        <div class="types-grid">
          <div class="type-card" data-report="sales">
            <div class="card-icon">ğŸ“Š</div>
            <h3>é”€å”®æŠ¥å‘Š</h3>
            <p>æŸ¥çœ‹å•†å“é”€å”®æ•°æ®å’Œè¶‹åŠ¿åˆ†æ</p>
          </div>
          <div class="type-card" data-report="performance">
            <div class="card-icon">ğŸ“ˆ</div>
            <h3>ç»©æ•ˆæŠ¥å‘Š</h3>
            <p>è¯„ä¼°åˆä½œæ–¹ç»©æ•ˆå’Œè½¬åŒ–ç‡</p>
          </div>
          <div class="type-card" data-report="inventory">
            <div class="card-icon">ğŸ“¦</div>
            <h3>åº“å­˜æŠ¥å‘Š</h3>
            <p>ç›‘æ§å•†å“åº“å­˜çŠ¶æ€å’Œå‘¨è½¬ç‡</p>
          </div>
          <div class="type-card" data-report="finance">
            <div class="card-icon">ğŸ’°</div>
            <h3>è´¢åŠ¡æŠ¥å‘Š</h3>
            <p>æŸ¥çœ‹ç»“ç®—æ•°æ®å’Œä½£é‡‘åˆ†é…</p>
          </div>
        </div>
      </section>

      <!-- æŠ¥å‘Šç”ŸæˆåŒºåŸŸ -->
      <section class="report-generator">
        <h2>ç”Ÿæˆè‡ªå®šä¹‰æŠ¥å‘Š</h2>
        <form id="report-form" class="report-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="report-type">æŠ¥å‘Šç±»å‹ *</label>
              <select id="report-type" name="report_type" required>
                <option value="">è¯·é€‰æ‹©æŠ¥å‘Šç±»å‹</option>
                <option value="sales">é”€å”®æŠ¥å‘Š</option>
                <option value="performance">ç»©æ•ˆæŠ¥å‘Š</option>
                <option value="inventory">åº“å­˜æŠ¥å‘Š</option>
                <option value="finance">è´¢åŠ¡æŠ¥å‘Š</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="time-range">æ—¶é—´èŒƒå›´ *</label>
              <select id="time-range" name="time_range" required>
                <option value="">è¯·é€‰æ‹©æ—¶é—´èŒƒå›´</option>
                <option value="è¿‘7å¤©">è¿‘7å¤©</option>
                <option value="è¿‘30å¤©">è¿‘30å¤©</option>
                <option value="è¿‘90å¤©">è¿‘90å¤©</option>
                <option value="è‡ªå®šä¹‰">è‡ªå®šä¹‰</option>
              </select>
            </div>
            
            <div class="form-group custom-date" style="display: none;">
              <label for="start-date">å¼€å§‹æ—¥æœŸ</label>
              <input type="date" id="start-date" name="start_date">
            </div>
            
            <div class="form-group custom-date" style="display: none;">
              <label for="end-date">ç»“æŸæ—¥æœŸ</label>
              <input type="date" id="end-date" name="end_date">
            </div>
            
            <div class="form-group">
              <label for="platform">å¹³å°</label>
              <select id="platform" name="platform">
                <option value="all">å…¨éƒ¨å¹³å°</option>
                <option value="æŠ–éŸ³">æŠ–éŸ³</option>
                <option value="è§†é¢‘å·">è§†é¢‘å·</option>
                <option value="å…¶ä»–">å…¶ä»–</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="format">å¯¼å‡ºæ ¼å¼</label>
              <select id="format" name="format">
                <option value="pdf">PDF</option>
                <option value="excel">Excel</option>
                <option value="csv">CSV</option>
              </select>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="button" id="preview-btn">é¢„è§ˆæŠ¥å‘Š</button>
            <button type="submit" class="generate-btn">ç”ŸæˆæŠ¥å‘Š</button>
          </div>
        </form>
      </section>

      <!-- æŠ¥å‘Šé¢„è§ˆåŒºåŸŸ -->
      <section class="report-preview" id="report-preview" style="display: none;">
        <h2>æŠ¥å‘Šé¢„è§ˆ</h2>
        <div class="preview-content">
          <div class="preview-header">
            <h3 id="preview-title">é”€å”®æŠ¥å‘Š - è¿‘30å¤©</h3>
            <button id="close-preview">Ã—</button>
          </div>
          <div class="preview-data" id="preview-data">
            <!-- é¢„è§ˆæ•°æ®å°†é€šè¿‡APIåŠ¨æ€åŠ è½½ -->
            <div class="loading">åŠ è½½é¢„è§ˆæ•°æ®...</div>
          </div>
          <div class="preview-actions">
            <button id="export-btn" class="export-btn">å¯¼å‡ºæŠ¥å‘Š</button>
          </div>
        </div>
      </section>

      <!-- å†å²æŠ¥å‘Š -->
      <section class="history-reports">
        <h2>å†å²æŠ¥å‘Š</h2>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>æŠ¥å‘Šåç§°</th>
                <th>ç±»å‹</th>
                <th>ç”Ÿæˆæ—¶é—´</th>
                <th>çŠ¶æ€</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody id="history-table-body">
              <tr>
                <td colspan="5" class="loading">åŠ è½½ä¸­...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>
</Layout>

<script>
  // DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
  document.addEventListener('DOMContentLoaded', async () => {
    // åˆå§‹åŒ–é¡µé¢æ•°æ®
    await loadHistoryReports();
    
    // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
    bindEventListeners();
  });

  // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
  const bindEventListeners = () => {
    // æŠ¥å‘Šç±»å‹å¡ç‰‡ç‚¹å‡»äº‹ä»¶
    document.querySelectorAll('.type-card').forEach(card => {
      card.addEventListener('click', (event) => {
        const reportType = event.currentTarget.dataset.report;
        generateQuickReport(reportType);
      });
    });
    
    // æ—¶é—´èŒƒå›´é€‰æ‹©å˜åŒ–äº‹ä»¶
    document.getElementById('time-range').addEventListener('change', (event) => {
      const customDateFields = document.querySelectorAll('.custom-date');
      if (event.target.value === 'è‡ªå®šä¹‰') {
        customDateFields.forEach(field => {
          field.style.display = 'block';
        });
      } else {
        customDateFields.forEach(field => {
          field.style.display = 'none';
        });
      }
    });
    
    // è¡¨å•æäº¤äº‹ä»¶
    document.getElementById('report-form').addEventListener('submit', handleReportGenerate);
    
    // é¢„è§ˆæŒ‰é’®äº‹ä»¶
    document.getElementById('preview-btn').addEventListener('click', handlePreview);
    
    // å…³é—­é¢„è§ˆäº‹ä»¶
    document.getElementById('close-preview').addEventListener('click', () => {
      document.getElementById('report-preview').style.display = 'none';
    });
    
    // å¯¼å‡ºæŒ‰é’®äº‹ä»¶
    document.getElementById('export-btn').addEventListener('click', handleExport);
  };

  // ç”Ÿæˆå¿«é€ŸæŠ¥å‘Š
  const generateQuickReport = async (reportType) => {
    try {
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      showNotification('æ­£åœ¨ç”ŸæˆæŠ¥å‘Š...', 'info');
      
      // æ¨¡æ‹ŸAPIè°ƒç”¨
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      // æ˜¾ç¤ºé¢„è§ˆ
      showReportPreview(reportType);
      
      showNotification('æŠ¥å‘Šç”ŸæˆæˆåŠŸ', 'success');
    } catch (error) {
      console.error('ç”ŸæˆæŠ¥å‘Šå¤±è´¥:', error);
      showNotification('æŠ¥å‘Šç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
    }
  };

  // å¤„ç†æŠ¥å‘Šé¢„è§ˆ
  const handlePreview = async () => {
    const reportType = document.getElementById('report-type').value;
    
    if (!reportType) {
      showNotification('è¯·é€‰æ‹©æŠ¥å‘Šç±»å‹', 'error');
      return;
    }
    
    try {
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      showNotification('æ­£åœ¨ç”Ÿæˆé¢„è§ˆ...', 'info');
      
      // æ¨¡æ‹ŸAPIè°ƒç”¨
      await new Promise(resolve => setTimeout(resolve, 800));
      
      // æ˜¾ç¤ºé¢„è§ˆ
      showReportPreview(reportType);
      
      showNotification('é¢„è§ˆç”ŸæˆæˆåŠŸ', 'success');
    } catch (error) {
      console.error('ç”Ÿæˆé¢„è§ˆå¤±è´¥:', error);
      showNotification('é¢„è§ˆç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
    }
  };

  // æ˜¾ç¤ºæŠ¥å‘Šé¢„è§ˆ
  const showReportPreview = (reportType) => {
    // è®¾ç½®é¢„è§ˆæ ‡é¢˜
    const titles = {
      'sales': 'é”€å”®æŠ¥å‘Š',
      'performance': 'ç»©æ•ˆæŠ¥å‘Š',
      'inventory': 'åº“å­˜æŠ¥å‘Š',
      'finance': 'è´¢åŠ¡æŠ¥å‘Š'
    };
    
    document.getElementById('preview-title').textContent = `${titles[reportType] || 'æŠ¥å‘Š'} - è¿‘30å¤©`;
    
    // æ¨¡æ‹Ÿé¢„è§ˆæ•°æ®
    const previewData = `
      <div class="report-summary">
        <h4>æŠ¥å‘Šæ‘˜è¦</h4>
        <div class="summary-grid">
          <div class="summary-item">
            <label>æ€»é”€å”®é¢:</label>
            <span>Â¥1,250,000</span>
          </div>
          <div class="summary-item">
            <label>æ€»è®¢å•æ•°:</label>
            <span>15,620</span>
          </div>
          <div class="summary-item">
            <label>å¹³å‡å®¢å•ä»·:</label>
            <span>Â¥79.99</span>
          </div>
          <div class="summary-item">
            <label>è½¬åŒ–ç‡:</label>
            <span>3.8%</span>
          </div>
        </div>
      </div>
      
      <div class="report-charts">
        <h4>æ•°æ®å›¾è¡¨</h4>
        <div class="chart-placeholder">
          <p>é”€å”®è¶‹åŠ¿å›¾</p>
          <div class="chart-area">
            <div class="bar-chart">
              <div class="bar" style="height: 80%; background: #007BFF;"></div>
              <div class="bar" style="height: 65%; background: #28A745;"></div>
              <div class="bar" style="height: 90%; background: #FFC107;"></div>
              <div class="bar" style="height: 75%; background: #DC3545;"></div>
              <div class="bar" style="height: 85%; background: #6F42C1;"></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="report-details">
        <h4>è¯¦ç»†æ•°æ®</h4>
        <table>
          <thead>
            <tr>
              <th>å•†å“åç§°</th>
              <th>é”€å”®é‡</th>
              <th>é”€å”®é¢</th>
              <th>è½¬åŒ–ç‡</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>ç»´ç”Ÿç´ Cç‰‡</td>
              <td>1,250</td>
              <td>Â¥62,500</td>
              <td>4.2%</td>
            </tr>
            <tr>
              <td>é’™ç‰‡</td>
              <td>980</td>
              <td>Â¥49,000</td>
              <td>3.8%</td>
            </tr>
            <tr>
              <td>é±¼æ²¹èƒ¶å›Š</td>
              <td>750</td>
              <td>Â¥37,500</td>
              <td>3.5%</td>
            </tr>
          </tbody>
        </table>
      </div>
    `;
    
    document.getElementById('preview-data').innerHTML = previewData;
    document.getElementById('report-preview').style.display = 'block';
  };

  // å¤„ç†æŠ¥å‘Šç”Ÿæˆ
  const handleReportGenerate = async (event) => {
    event.preventDefault();
    
    const formData = new FormData(event.target);
    const data = Object.fromEntries(formData.entries());
    
    try {
      // æ˜¾ç¤ºæäº¤çŠ¶æ€
      const generateBtn = document.querySelector('.generate-btn');
      const originalText = generateBtn.textContent;
      generateBtn.textContent = 'ç”Ÿæˆä¸­...';
      generateBtn.disabled = true;
      
      // æ¨¡æ‹ŸAPIè°ƒç”¨
      await new Promise(resolve => setTimeout(resolve, 1500));
      
      // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
      showNotification('æŠ¥å‘Šç”ŸæˆæˆåŠŸï¼Œå·²æ·»åŠ åˆ°å†å²è®°å½•', 'success');
      
      // é‡æ–°åŠ è½½å†å²è®°å½•
      await loadHistoryReports();
      
      // é‡ç½®è¡¨å•
      event.target.reset();
      document.querySelectorAll('.custom-date').forEach(field => {
        field.style.display = 'none';
      });
      
    } catch (error) {
      console.error('ç”ŸæˆæŠ¥å‘Šå¤±è´¥:', error);
      showNotification('æŠ¥å‘Šç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
    } finally {
      // æ¢å¤æäº¤æŒ‰é’®
      const generateBtn = document.querySelector('.generate-btn');
      generateBtn.textContent = 'ç”ŸæˆæŠ¥å‘Š';
      generateBtn.disabled = false;
    }
  };

  // å¤„ç†æŠ¥å‘Šå¯¼å‡º
  const handleExport = () => {
    showNotification('æŠ¥å‘Šå¯¼å‡ºä¸­...', 'info');
    
    // æ¨¡æ‹Ÿå¯¼å‡ºè¿‡ç¨‹
    setTimeout(() => {
      showNotification('æŠ¥å‘Šå¯¼å‡ºæˆåŠŸ', 'success');
    }, 1000);
  };

  // åŠ è½½å†å²æŠ¥å‘Š
  const loadHistoryReports = async () => {
    const tableBody = document.getElementById('history-table-body');
    
    try {
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      tableBody.innerHTML = '<tr><td colspan="5" class="loading">åŠ è½½ä¸­...</td></tr>';
      
      // æ¨¡æ‹ŸAPIè°ƒç”¨
      await new Promise(resolve => setTimeout(resolve, 500));
      
      // æ¨¡æ‹Ÿå†å²æŠ¥å‘Šæ•°æ®
      const reports = [
        {
          id: 'report_001',
          name: 'æœˆåº¦é”€å”®æŠ¥å‘Š_202510',
          type: 'é”€å”®æŠ¥å‘Š',
          generated_at: '2025-10-01 14:30',
          status: 'completed'
        },
        {
          id: 'report_002',
          name: 'å­£åº¦ç»©æ•ˆæŠ¥å‘Š_2025Q3',
          type: 'ç»©æ•ˆæŠ¥å‘Š',
          generated_at: '2025-09-30 16:45',
          status: 'completed'
        },
        {
          id: 'report_003',
          name: 'åº“å­˜å‘¨è½¬æŠ¥å‘Š_202509',
          type: 'åº“å­˜æŠ¥å‘Š',
          generated_at: '2025-09-25 10:15',
          status: 'completed'
        }
      ];
      
      renderHistoryReports(reports);
    } catch (error) {
      console.error('åŠ è½½å†å²æŠ¥å‘Šå¤±è´¥:', error);
      tableBody.innerHTML = '<tr><td colspan="5" class="error">æ•°æ®åŠ è½½å¤±è´¥</td></tr>';
    }
  };

  // æ¸²æŸ“å†å²æŠ¥å‘Š
  const renderHistoryReports = (reports) => {
    const tableBody = document.getElementById('history-table-body');
    
    if (!reports || reports.length === 0) {
      tableBody.innerHTML = '<tr><td colspan="5" class="empty">æš‚æ— å†å²æŠ¥å‘Š</td></tr>';
      return;
    }
    
    tableBody.innerHTML = reports.map(report => {
      const getStatusText = (status) => {
        switch (status) {
          case 'completed': return 'å·²å®Œæˆ';
          case 'processing': return 'å¤„ç†ä¸­';
          case 'failed': return 'å¤±è´¥';
          default: return status;
        }
      };
      
      const getStatusClass = (status) => {
        switch (status) {
          case 'completed': return 'status-completed';
          case 'processing': return 'status-processing';
          case 'failed': return 'status-failed';
          default: return '';
        }
      };
      
      return `
        <tr>
          <td>${report.name}</td>
          <td>${report.type}</td>
          <td>${report.generated_at}</td>
          <td><span class="status-badge ${getStatusClass(report.status)}">${getStatusText(report.status)}</span></td>
          <td>
            <button class="action-btn view-btn" data-report-id="${report.id}">æŸ¥çœ‹</button>
            <button class="action-btn download-btn" data-report-id="${report.id}">ä¸‹è½½</button>
          </td>
        </tr>
      `;
    }).join('');
    
    // ä¸ºæ“ä½œæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
    document.querySelectorAll('.view-btn').forEach(btn => {
      btn.addEventListener('click', (event) => {
        const reportId = event.target.dataset.reportId;
        viewReport(reportId);
      });
    });
    
    document.querySelectorAll('.download-btn').forEach(btn => {
      btn.addEventListener('click', (event) => {
        const reportId = event.target.dataset.reportId;
        downloadReport(reportId);
      });
    });
  };

  // æŸ¥çœ‹æŠ¥å‘Š
  const viewReport = (reportId) => {
    showNotification('æ­£åœ¨æ‰“å¼€æŠ¥å‘Š...', 'info');
    
    // æ¨¡æ‹Ÿæ‰“å¼€æŠ¥å‘Š
    setTimeout(() => {
      showNotification('æŠ¥å‘Šå·²æ‰“å¼€', 'success');
    }, 500);
  };

  // ä¸‹è½½æŠ¥å‘Š
  const downloadReport = (reportId) => {
    showNotification('æ­£åœ¨å‡†å¤‡ä¸‹è½½...', 'info');
    
    // æ¨¡æ‹Ÿä¸‹è½½è¿‡ç¨‹
    setTimeout(() => {
      showNotification('æŠ¥å‘Šä¸‹è½½æˆåŠŸ', 'success');
    }, 1000);
  };

  // æ˜¾ç¤ºé€šçŸ¥
  const showNotification = (message, type) => {
    // ç§»é™¤ç°æœ‰çš„é€šçŸ¥
    const existingNotification = document.querySelector('.report-notification');
    if (existingNotification) {
      existingNotification.remove();
    }
    
    const notification = document.createElement('div');
    notification.className = `report-notification ${type}`;
    notification.textContent = message;
    notification.style.cssText = `
      position: fixed;
      top: 80px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 4px;
      color: white;
      font-weight: 500;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      ${type === 'success' ? 'background: #28a745;' : 
        type === 'error' ? 'background: #dc3545;' : 
        type === 'info' ? 'background: #17a2b8;' : 
        'background: #6c757d;'}
    `;
    
    document.body.appendChild(notification);
    
    // 3ç§’åè‡ªåŠ¨ç§»é™¤
    setTimeout(() => {
      if (notification.parentElement) {
        notification.remove();
      }
    }, 3000);
  };
</script>

<style>
  #reports-page {
    font-family: Inter, Roboto, 'Helvetica Neue', 'Arial Nova', 'Nimbus Sans', Arial, sans-serif;
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
  }

  header {
    margin-bottom: 30px;
    text-align: center;
  }

  header h1 {
    margin: 0 0 10px 0;
    font-size: 28px;
    color: #2c3e50;
  }

  header p {
    margin: 0;
    color: #7f8c8d;
    font-size: 16px;
  }

  /* æŠ¥å‘Šç±»å‹å¡ç‰‡ */
  .report-types h2, .report-generator h2, .history-reports h2 {
    margin-top: 0;
    margin-bottom: 20px;
    color: #2c3e50;
  }

  .types-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
  }

  .type-card {
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 30px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .type-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: #3498db;
  }

  .card-icon {
    font-size: 48px;
    margin-bottom: 15px;
  }

  .type-card h3 {
    margin: 0 0 10px 0;
    color: #2c3e50;
    font-size: 20px;
  }

  .type-card p {
    margin: 0;
    color: #7f8c8d;
    font-size: 14px;
  }

  /* æŠ¥å‘Šç”Ÿæˆè¡¨å• */
  .report-form {
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 30px;
    margin-bottom: 40px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .form-group label {
    font-weight: 500;
    color: #2c3e50;
  }

  .form-group input,
  .form-group select {
    padding: 12px 15px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 16px;
  }

  .form-group input:focus,
  .form-group select:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.25);
  }

  .form-actions {
    display: flex;
    justify-content: center;
    gap: 20px;
  }

  #preview-btn, .generate-btn, .export-btn {
    padding: 12px 30px;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  #preview-btn {
    background: #95a5a6;
    color: white;
  }

  #preview-btn:hover {
    background: #7f8c8d;
  }

  .generate-btn {
    background: #3498db;
    color: white;
  }

  .generate-btn:hover {
    background: #2980b9;
  }

  .export-btn {
    background: #27ae60;
    color: white;
  }

  .export-btn:hover {
    background: #219653;
  }

  /* æŠ¥å‘Šé¢„è§ˆ */
  .report-preview {
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 30px;
    margin-bottom: 40px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .preview-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #e0e0e0;
  }

  .preview-header h3 {
    margin: 0;
    color: #2c3e50;
  }

  #close-preview {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #95a5a6;
  }

  #close-preview:hover {
    color: #7f8c8d;
  }

  .preview-data {
    margin-bottom: 20px;
  }

  .report-summary {
    margin-bottom: 30px;
  }

  .report-summary h4 {
    margin-top: 0;
    margin-bottom: 20px;
    color: #2c3e50;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
  }

  .summary-item {
    display: flex;
    flex-direction: column;
    gap: 5px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 6px;
  }

  .summary-item label {
    font-weight: 600;
    color: #2c3e50;
    font-size: 14px;
  }

  .summary-item span {
    font-size: 18px;
    font-weight: 700;
    color: #3498db;
  }

  .report-charts {
    margin-bottom: 30px;
  }

  .report-charts h4 {
    margin-top: 0;
    margin-bottom: 20px;
    color: #2c3e50;
  }

  .chart-placeholder {
    background: #f8f9fa;
    border-radius: 6px;
    padding: 20px;
    text-align: center;
  }

  .chart-placeholder p {
    margin-top: 0;
    margin-bottom: 20px;
    font-weight: 600;
    color: #2c3e50;
  }

  .chart-area {
    height: 200px;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    gap: 30px;
  }

  .bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 20px;
    height: 150px;
  }

  .bar {
    width: 40px;
    border-radius: 4px 4px 0 0;
    transition: height 0.5s;
  }

  .report-details {
    margin-bottom: 20px;
  }

  .report-details h4 {
    margin-top: 0;
    margin-bottom: 20px;
    color: #2c3e50;
  }

  .report-details table {
    width: 100%;
    border-collapse: collapse;
  }

  .report-details th,
  .report-details td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid #e0e0e0;
  }

  .report-details th {
    background: #f8f9fa;
    font-weight: 600;
    color: #2c3e50;
  }

  .preview-actions {
    text-align: center;
  }

  /* å†å²æŠ¥å‘Š */
  .table-container {
    overflow-x: auto;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    background: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th, td {
    padding: 15px;
    text-align: left;
    border-bottom: 1px solid #e0e0e0;
  }

  th {
    background: #f8f9fa;
    font-weight: 600;
    color: #2c3e50;
  }

  .action-btn {
    padding: 6px 12px;
    margin: 0 5px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }

  .view-btn {
    background: #3498db;
    color: white;
  }

  .view-btn:hover {
    background: #2980b9;
  }

  .download-btn {
    background: #27ae60;
    color: white;
  }

  .download-btn:hover {
    background: #219653;
  }

  .status-badge {
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
  }

  .status-completed {
    background: #27ae60;
    color: white;
  }

  .status-processing {
    background: #f39c12;
    color: white;
  }

  .status-failed {
    background: #e74c3c;
    color: white;
  }

  /* åŠ è½½å’Œé”™è¯¯çŠ¶æ€æ ·å¼ */
  .loading, .empty, .error {
    text-align: center;
    padding: 40px 20px;
    color: #7f8c8d;
  }

  .error {
    color: #e74c3c;
  }

  .report-notification {
    position: fixed;
    top: 80px;
    right: 20px;
    padding: 15px 20px;
    border-radius: 4px;
    color: white;
    font-weight: 500;
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .report-notification.success {
    background: #27ae60;
  }

  .report-notification.error {
    background: #e74c3c;
  }

  .report-notification.info {
    background: #3498db;
  }

  /* å“åº”å¼è®¾è®¡ */
  @media (max-width: 768px) {
    #reports-page {
      padding: 10px;
    }
    
    .types-grid {
      grid-template-columns: 1fr;
    }
    
    .form-grid {
      grid-template-columns: 1fr;
    }
    
    .summary-grid {
      grid-template-columns: 1fr 1fr;
    }
    
    .chart-area {
      gap: 15px;
    }
    
    .bar-chart {
      gap: 10px;
    }
    
    .bar {
      width: 25px;
    }
  }

  @media (max-width: 480px) {
    header h1 {
      font-size: 24px;
    }
    
    .form-actions {
      flex-direction: column;
      gap: 10px;
    }
    
    .action-btn {
      display: block;
      margin: 5px 0;
      width: 100%;
    }
    
    .summary-grid {
      grid-template-columns: 1fr;
    }
  }
</style>